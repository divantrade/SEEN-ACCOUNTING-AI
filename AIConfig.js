// ==================== ุฅุนุฏุงุฏุงุช ุงูุจูุช ุงูุฐูู ====================
/**
 * ููู ุฅุนุฏุงุฏุงุช ุงูุจูุช ุงูุฐูู ููุธุงู SEEN ุงููุญุงุณุจู
 * ูุณุชุฎุฏู Gemini Flash ููุชุญููู ุงูุฐูู ูููุตูุต ุงูุทุจูุนูุฉ
 */

const AI_CONFIG = {

    // ==================== ุฅุนุฏุงุฏุงุช Gemini API ====================
    // ==================== ุฅุนุฏุงุฏุงุช Gemini API ====================
    GEMINI: {
        // ุงูุฑุงุจุท ุงูุฃุณุงุณู (ุณูุชู ุฅุถุงูุฉ ุงุณู ุงูููุฏูู ุฏููุงููููุงู)
        BASE_URL: 'https://generativelanguage.googleapis.com/v1beta/models/',

        // ุงูููุฏูู ุงูุฃุณุงุณู ูุงูููุฏููุงุช ุงูุจุฏููุฉ
        MODEL: 'gemini-2.0-flash',
        FALLBACK_MODELS: [
            'gemini-2.0-flash',
            'gemini-2.0-flash-001',
            'gemini-flash-latest',
            'gemini-pro-latest',
            'gemini-2.0-flash-lite',
            'gemini-2.0-flash-exp',
            'gemini-1.5-flash',
            'gemini-pro'
        ],

        // ุฅุนุฏุงุฏุงุช ุงูุชูููุฏ
        GENERATION_CONFIG: {
            temperature: 0.1,           // ุฏูุฉ ุนุงููุฉ (ููู ููุฎูุถุฉ = ุฃูุซุฑ ุชุญุฏูุฏุงู)
            topP: 0.8,
            topK: 40,
            maxOutputTokens: 2048       // ุฒูุงุฏุฉ ุงูุญุฏ ูููุน ูุทุน ุงูุฑุฏ
        },

        // ุฅุนุฏุงุฏุงุช ุงูุฃูุงู
        SAFETY_SETTINGS: [
            { category: 'HARM_CATEGORY_HARASSMENT', threshold: 'BLOCK_NONE' },
            { category: 'HARM_CATEGORY_HATE_SPEECH', threshold: 'BLOCK_NONE' },
            { category: 'HARM_CATEGORY_SEXUALLY_EXPLICIT', threshold: 'BLOCK_NONE' },
            { category: 'HARM_CATEGORY_DANGEROUS_CONTENT', threshold: 'BLOCK_NONE' }
        ]
    },

    // ==================== ููุงุญุธุฉ: ุดูุช ุงููุณุชุฎุฏููู ====================
    // ุชู ุชูุญูุฏ ุดูุช ุงููุณุชุฎุฏููู - ููุณุชุฎุฏู ุงูุขู CONFIG.SHEETS.BOT_USERS
    // ูุน ุฃุนูุฏุฉ Checkboxes ููุตูุงุญูุงุช ุงููุชุนุฏุฏุฉ (ุจูุช ุชูููุฏูุ ุจูุช ุฐููุ ุดูุชุ ูุฑุงุฌุนุฉ)
    // ุงูุธุฑ BOT_CONFIG.BOT_USERS_COLUMNS ูููููู ุงูุฌุฏูุฏ

    // ==================== ููุงุนุฏ ุงูุงุณุชูุชุงุฌ ุงูุฐูู ====================
    INFERENCE_RULES: {

        // ุงุณุชูุชุงุฌ ุทุจูุนุฉ ุงูุญุฑูุฉ ูู ุงูุฃูุนุงู
        NATURE_KEYWORDS: {
            'ุงุณุชุญูุงู': ['ุงุชููุช', 'ุงุชูููุง', 'ุชู ุงูุงุชูุงู', 'ุนูุฏ', 'ุชุนุงูุฏ', 'ุทูุจ', 'ุทูุจุช', 'ุญุฌุฒ', 'ุญุฌุฒุช', 'ุณูุชู', 'ุณุฃุฏูุน', 'ูุณุชุญู', 'ูุณุชุญู', 'ูุญุงุณุจ', 'ุณูุญุงุณุจ', 'ููุญุงุณุจ', 'ุญูุญุงุณุจ', 'ูุฏูุน', 'ุณูุฏูุน', 'ููุฏูุน', 'ุญูุฏูุน'],
            'ุฏูุนุฉ': ['ุฏูุนุช', 'ุณุฏุฏุช', 'ุญููุช', 'ุฃุฑุณูุช', 'ุตุฑูุช', 'ุฃุนุทูุช', 'ุณููุช', 'ุฏูุน', 'ุชุญููู', 'ุณุฏุงุฏ'],
            'ุชุญุตูู': ['ุงุณุชููุช', 'ูุจุถุช', 'ูุตููู', 'ุญุตูุช', 'ุชุณููุช', 'ุฌุงูู', 'ูุตู', 'ุงุณุชูุงู', 'ุชุญุตูู', 'ูุจุถ'],
            // ุงููุตุงุฑูู ุงูุจูููุฉ ุชูุนุงูู ูู "ุฏูุนุฉ" ูุน ุจูุฏ "ูุตุงุฑูู ุจูููุฉ"
            'ุฏูุนุฉ_ุจูููุฉ': ['ูุตุงุฑูู ุจูููุฉ', 'ุนูููุฉ ุจูููุฉ', 'ุฑุณูู ุจูููุฉ', 'ูุตุงุฑูู ุชุญููู', 'ุนูููุฉ ุชุญููู', 'ุฑุณูู ุญูุงูุฉ', 'ูุตุงุฑูู ุงูุจูู', 'ุนูููุฉ ุงูุจูู']
        },

        // ุงุณุชูุชุงุฌ ุงูุชุตููู ูู ููุน ุงูุญุฑูุฉ
        CLASSIFICATION_RULES: {
            'ูุตุฑูู_ูุจุงุดุฑ': ['ุฑุณู', 'ุชุตููู', 'ูููุชุงุฌ', 'ุชุตููุฑ', 'ูุชุงุจุฉ', 'ุฅุฎุฑุงุฌ', 'ุชุญุฑูุฑ', 'ุณููุงุฑูู', 'ุตูุช', 'ููุณููู', 'ุฌุฑุงููู', 'ุฃููููุดู', 'ุชุนููู', 'ุชุฑุฌูุฉ', 'ุฏุจูุฌุฉ'],
            'ูุตุฑูู_ุนูููู': ['ุฅูุฌุงุฑ', 'ููุฑุจุงุก', 'ูุงุก', 'ูุช', 'ุงูุชุฑูุช', 'ูุงุชู', 'ููุจุงูู', 'ููุงุตูุงุช', 'ููู', 'ุณูุฑ', 'ุชุฐุงูุฑ', 'ููุฏู', 'ุฅูุงูุฉ', 'ุทุนุงู', 'ุถูุงูุฉ', 'ูุฑุทุงุณูุฉ', 'ุตูุงูุฉ', 'ูุฑุชุจุงุช', 'ุฑุงุชุจ', 'ุฑูุงุชุจ', 'ุฃุฌูุฑ', 'ูุฑุชุจ', 'ููุงูุฃุฉ', 'ููุงูุขุช', 'ุญูุงูุฒ', 'ุจุฏูุงุช'],
            'ุงูุฑุงุฏ': ['ูู ุงูุนููู', 'ููุงุจู ูุดุฑูุน', 'ุฏูุนุฉ ูู', 'ุฅูุฑุงุฏ', 'ูุงุชูุฑุฉ', 'ูุณุชุญูุงุช', 'ุฃุชุนุงุจ'],
            'ุชูููู': ['ูุฑุถ', 'ุณููุฉ', 'ุชูููู', 'ุงูุชุฑุงุถ', 'ุงุณุชุฏุงูุฉ']
        },

        // ุงุณุชูุชุงุฌ ุงูุนููุฉ
        CURRENCY_KEYWORDS: {
            'USD': ['ุฏููุงุฑ', '$', 'USD', 'ุฏููุงุฑุงุช', 'ุงูุฑููู'],
            'TRY': ['ููุฑุฉ', 'TL', 'TRY', 'ููุฑุงุช', 'ุชุฑูู', 'ุชุฑููุฉ'],
            'EGP': ['ุฌููู', 'EGP', 'ุฌูููุงุช', 'ูุตุฑู', 'ูุตุฑูุฉ']
        },

        // ุงุณุชูุชุงุฌ ุทุฑููุฉ ุงูุฏูุน
        PAYMENT_METHOD_KEYWORDS: {
            'ููุฏู': ['ูุงุด', 'ููุฏุงู', 'ููุฏู', 'cash', 'ูุฏ ุจูุฏ', 'ุจุงููุฏ'],
            'ุชุญููู ุจููู': ['ุชุญููู', 'ุจูู', 'ุญูุงูุฉ', 'transfer', 'ุจููู', 'ุญุณุงุจ'],
            'ุจุทุงูุฉ': ['ุจุทุงูุฉ', 'ููุฒุง', 'ูุงุฑุช', 'visa', 'card', 'ูุงุณุชุฑ']
        },

        // ุงูููู ุงูุงูุชุฑุงุถูุฉ
        DEFAULTS: {
            CURRENCY: 'USD',
            PAYMENT_METHOD: 'ุชุญููู ุจููู',
            PAYMENT_TERM: 'ููุฑู'
        }
    },

    // ==================== ุงูุญููู ุงูุฅูุฒุงููุฉ ====================
    REQUIRED_FIELDS: {
        // ุญููู ุฅูุฒุงููุฉ ููู ุฃููุงุน ุงูุญุฑูุงุช
        ALWAYS: ['amount', 'party'],

        // ุญููู ุฅูุฒุงููุฉ ุญุณุจ ุงูุชุตููู
        BY_CLASSIFICATION: {
            'ูุตุฑููุงุช ูุจุงุดุฑุฉ': ['project'],
            'ุงูุฑุงุฏ': ['project'],
            'ูุตุฑููุงุช ุนููููุฉ': [],
            'ุชูููู ุทููู ุงูุฃุฌู': [],
            'ุณููุฉ ูุตูุฑุฉ': []
        }
    },

    // ==================== ุญุงูุงุช ุงููุญุงุฏุซุฉ ููุจูุช ุงูุฐูู ====================
    AI_CONVERSATION_STATES: {
        IDLE: 'ai_idle',
        WAITING_MISSING_FIELD: 'ai_waiting_missing_field',
        WAITING_PROJECT_SELECTION: 'ai_waiting_project',
        WAITING_PARTY_SELECTION: 'ai_waiting_party',
        WAITING_NEW_PARTY_CONFIRM: 'ai_waiting_new_party_confirm',
        WAITING_PAYMENT_METHOD: 'ai_waiting_payment_method',      // โญ ุงูุชุธุงุฑ ุทุฑููุฉ ุงูุฏูุน
        WAITING_CURRENCY: 'ai_waiting_currency',                  // โญ ุงูุชุธุงุฑ ุงูุนููุฉ
        WAITING_EXCHANGE_RATE: 'ai_waiting_exchange_rate',        // โญ ุงูุชุธุงุฑ ุณุนุฑ ุงูุตุฑู
        WAITING_PAYMENT_TERM: 'ai_waiting_payment_term',          // โญ ุงูุชุธุงุฑ ุดุฑุท ุงูุฏูุน
        WAITING_LOAN_DUE_DATE: 'ai_waiting_loan_due_date',        // โญ ุงูุชุธุงุฑ ุชุงุฑูุฎ ุงุณุชุญูุงู ุงูุณููุฉ
        WAITING_CONFIRMATION: 'ai_waiting_confirmation',
        WAITING_EDIT: 'ai_waiting_edit',
        CONFIRM_WAIT: 'ai_confirm_wait',
        WAITING_SHARED_ORDER_CONFIRMATION: 'ai_waiting_shared_order_confirm',  // โญ ุงูุชุธุงุฑ ุชุฃููุฏ ุงูุฃูุฑุฏุฑ ุงููุดุชุฑู
        WAITING_SMART_PAYMENT_CONFIRM: 'ai_waiting_smart_payment',           // โญ ุงูุชุธุงุฑ ุชุฃููุฏ ุงูุชูุฒูุน ุงูุฐูู ููุฏูุนุฉ
        WAITING_ADVANCE_PROJECT: 'ai_waiting_advance_project'                // โญ ุงูุชุธุงุฑ ุงุฎุชูุงุฑ ูุดุฑูุน ููุฏูุนุฉ ุงูููุฏูุฉ
    },

    // ==================== ุงูุฑุณุงุฆู ====================
    AI_MESSAGES: {
        WELCOME: `
๐ค *ูุฑุญุจุงู ุจู ูู ุงูุจูุช ุงูุฐูู ููุธุงู SEEN*

ุฃูุง ุฃููู ุงููุบุฉ ุงูุทุจูุนูุฉ! ููุท ุฃุฎุจุฑูู ุจุงูุญุฑูุฉ ุงููุงููุฉ ูุณุฃููููุง.

*ุฃูุซูุฉ:*
โข "ุงุชููุช ูุน ุฃุญูุฏ ุนูู ุฑุณู ูููู X ุจู 400 ุฏููุงุฑ"
โข "ุฏูุนุช 200 ุฏููุงุฑ ููุญูุฏ ุฅูุฌุงุฑ ุงูููุชุจ"
โข "ุงุณุชููุช 1000 ุฏููุงุฑ ูู ุงูุนููู ููุงุจู ุงููุดุฑูุน"

๐ *ููุท ุงูุชุจ ุงูุญุฑูุฉ ุจุฃุณููุจู ุงูุทุจูุนู!*
        `,

        ANALYZING: '๐ *ุฌุงุฑู ุชุญููู ุงูุญุฑูุฉ...*',

        ASK_PROJECT: '๐ฌ *ูุง ูู ุงููุดุฑูุนุ*\n\nุงุฎุชุฑ ูู ุงููุงุฆูุฉ ุฃู ุงูุชุจ ุงุณู ุงููุดุฑูุน:',
        ASK_PARTY: '๐ค *ูู ูู ุงูุทุฑู (ุงูููุฑุฏ/ุงูุนููู)ุ*\n\nุงุฎุชุฑ ูู ุงููุงุฆูุฉ ุฃู ุงูุชุจ ุงูุงุณู:',
        ASK_AMOUNT: '๐ฐ *ูุง ูู ุงููุจูุบุ*\n\nุงูุชุจ ุงููุจูุบ (ูุซุงู: 500 ุฏููุงุฑ)',
        ASK_PAYMENT_METHOD: '๐ฆ *ูุง ูู ุทุฑููุฉ ุงูุฏูุนุ*\n\nุงุฎุชุฑ ูู ุงููุงุฆูุฉ:',
        ASK_CURRENCY: '๐ฑ *ูุง ูู ุงูุนููุฉุ*\n\nุงุฎุชุฑ ูู ุงููุงุฆูุฉ:',
        ASK_EXCHANGE_RATE: '๐ *ูุง ูู ุณุนุฑ ุงูุตุฑูุ*\n\nุงูุชุจ ุณุนุฑ ุตุฑู {currency} ููุงุจู ุงูุฏููุงุฑ:',
        ASK_PAYMENT_TERM: 'โฐ *ูุง ูู ุดุฑุท ุงูุฏูุนุ*\n\nูุชู ุณูุชู ุงูุฏูุนุ',
        ASK_PAYMENT_TERM_WEEKS: '๐ *ูู ุฃุณุจูุน ุจุนุฏ ุงูุชุณูููุ*\n\nุงูุชุจ ุนุฏุฏ ุงูุฃุณุงุจูุน (ูุซุงู: 2):',
        ASK_PAYMENT_TERM_DATE: '๐ *ูุง ูู ุชุงุฑูุฎ ุงูุฏูุนุ*\n\nุงูุชุจ ุงูุชุงุฑูุฎ (ูุซุงู: 15/2/2026):',

        PARTY_NOT_FOUND: `
โ๏ธ *ูู ุฃุฌุฏ "{party_name}"*

ูู ุชูุตุฏ ุฃุญุฏ ูุคูุงุกุ
{suggestions}

ุฃู ุงุฎุชุฑ: โ ุฅุถุงูุฉ ูุทุฑู ุฌุฏูุฏ
        `,

        CONFIRMATION_HEADER: '๐ *ุชุฃููุฏ ุงูุญุฑูุฉ*\nโโโโโโโโโโโโโโโโ',

        SUCCESS: 'โ *ุชู ุชุณุฌูู ุงูุญุฑูุฉ ุจูุฌุงุญ!*\n\n๐ ุฑูู ุงูุญุฑูุฉ: #{id}\n๐ ุชู ุงูุญูุธ ูู ุฏูุชุฑ ุงูุญุฑูุงุช ูุจุงุดุฑุฉ',
        CANCELLED: 'โ *ุชู ุฅูุบุงุก ุงูุนูููุฉ*',

        ERROR_PARSE: 'โ *ูู ุฃุชููู ูู ููู ุงูุญุฑูุฉ*\n\nุญุงูู ุตูุงุบุชูุง ุจุดูู ุฃูุถุญุ ูุซุงู:\n"ุงุชููุช ูุน ุฃุญูุฏ ุนูู ุฑุณู ูููู X ุจู 400 ุฏููุงุฑ"',
        ERROR_API: 'โ *ุญุฏุซ ุฎุทุฃ ูู ุงูุงุชุตุงู*\n\nูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู',

        UNAUTHORIZED: 'โ *ุนุฐุฑุงูุ ุฃูุช ุบูุฑ ูุตุฑุญ ูู ุจุงุณุชุฎุฏุงู ูุฐุง ุงูุจูุช*\n\nุชูุงุตู ูุน ุงููุณุคูู ููุญุตูู ุนูู ุงูุตูุงุญูุฉ.',

        HELP: `
๐ค *ุฏููู ุงูุจูุช ุงูุฐูู*
โโโโโโโโโโโโโโโโ

*ููู ุฃุณุชุฎุฏููุ*
ููุท ุงูุชุจ ุงูุญุฑูุฉ ุงููุงููุฉ ุจูุบุชู ุงูุทุจูุนูุฉ!

*ุฃูุซูุฉ ุนูู ุงูุญุฑูุงุช:*

๐ค *ุงุณุชุญูุงู ูุตุฑูู:*
"ุงุชููุช ูุน ุฃุญูุฏ ูุงูู ุนูู ุฑุณู ูููู X ุจู 400 ุฏููุงุฑ ููู 1/2/2025"

๐ธ *ุฏูุนุฉ ูุตุฑูู:*
"ุฏูุนุช ูุฃุญูุฏ 500 ุฏููุงุฑ ุฑุณูู ุฑุณู"

๐ฅ *ุฅูุฑุงุฏ:*
"ุงุณุชููุช 1000 ุฏููุงุฑ ูู ููุงุฉ ุงูุฌุฒูุฑุฉ ููุงุจู ูููู X"

๐ฆ *ุชูููู:*
"ุงุณุชููุช ุณููุฉ 5000 ุฏููุงุฑ ูู ูุญูุฏ"

โโโโโโโโโโโโโโโโ
๐ *ุงูุชูุงุฑูุฑ ููุดูู ุงูุญุณุงุจ:*
/reports ุฃู /ุชูุงุฑูุฑ - ูุงุฆูุฉ ุงูุชูุงุฑูุฑ

*ุงูุชูุงุฑูุฑ ุงููุชุงุญุฉ:*
โข ๐ ูุดู ุญุณุงุจ (ุนููู/ููุฑุฏ/ูููู)
โข โฐ ุชูุจููุงุช ุงูุงุณุชุญูุงู
โข ๐ฐ ุชูุฑูุฑ ุงูุฃุฑุตุฏุฉ
โข ๐ ุฑุจุญูุฉ ุงููุดุงุฑูุน
โข ๐ ุชูุฑูุฑ ุงููุตุฑููุงุช
โข ๐ต ุชูุฑูุฑ ุงูุฅูุฑุงุฏุงุช

โโโโโโโโโโโโโโโโ
*ููุงุญุธุงุช:*
โข ุฃุฐูุฑ ุงููุจูุบ ูุงูุนููุฉ (ุฏููุงุฑ/ููุฑุฉ/ุฌููู)
โข ุฃุฐูุฑ ุงุณู ุงูุทุฑู (ุงูููุฑุฏ/ุงูุนููู/ุงููููู)
โข ุฃุฐูุฑ ุงููุดุฑูุน ุฅู ูุงู ูุตุฑูู ูุจุงุดุฑ
โข ููููู ุฐูุฑ ุงูุชุงุฑูุฎ ุฃู ุณูููู ุงูููู ุงูุชุฑุงุถูุงู
        `
    },

    // ==================== ููุญุงุช ุงูููุงุชูุญ ====================
    AI_KEYBOARDS: {
        // ุชุฃููุฏ ุงูุญุฑูุฉ
        CONFIRMATION: {
            inline_keyboard: [
                [
                    { text: 'โ ุชุฃููุฏ', callback_data: 'ai_confirm' },
                    { text: 'โ๏ธ ุชุนุฏูู', callback_data: 'ai_edit' },
                    { text: 'โ ุฅูุบุงุก', callback_data: 'ai_cancel' }
                ]
            ]
        },

        // ุฅุถุงูุฉ ุทุฑู ุฌุฏูุฏ
        ADD_NEW_PARTY: {
            inline_keyboard: [
                [
                    { text: 'โ ุฅุถุงูุฉ ูุทุฑู ุฌุฏูุฏ', callback_data: 'ai_add_party' }
                ],
                [
                    { text: 'โ ุฅูุบุงุก', callback_data: 'ai_cancel' }
                ]
            ]
        },

        // ุงุฎุชูุงุฑ ููุน ุงูุทุฑู ุงูุฌุฏูุฏ
        NEW_PARTY_TYPE: {
            inline_keyboard: [
                [
                    { text: '๐ญ ููุฑุฏ', callback_data: 'ai_partytype_ููุฑุฏ' },
                    { text: '๐ค ุนููู', callback_data: 'ai_partytype_ุนููู' },
                    { text: '๐ผ ูููู', callback_data: 'ai_partytype_ูููู' }
                ],
                [
                    { text: 'โ ุฅูุบุงุก', callback_data: 'ai_cancel' }
                ]
            ]
        },

        // ุญููู ุงูุชุนุฏูู
        EDIT_FIELDS: {
            inline_keyboard: [
                [
                    { text: '๐ค ุทุจูุนุฉ ุงูุญุฑูุฉ', callback_data: 'ai_edit_nature' },
                    { text: '๐ ุงูุชุตููู', callback_data: 'ai_edit_classification' }
                ],
                [
                    { text: '๐ฌ ุงููุดุฑูุน', callback_data: 'ai_edit_project' },
                    { text: '๐ ุงูุจูุฏ', callback_data: 'ai_edit_item' }
                ],
                [
                    { text: '๐ค ุงูุทุฑู', callback_data: 'ai_edit_party' },
                    { text: '๐ฐ ุงููุจูุบ', callback_data: 'ai_edit_amount' }
                ],
                [
                    { text: '๐ฑ ุงูุนููุฉ', callback_data: 'ai_edit_currency' },
                    { text: '๐ ุงูุชุงุฑูุฎ', callback_data: 'ai_edit_date' }
                ],
                [
                    { text: '๐ ุงูุชูุงุตูู', callback_data: 'ai_edit_details' }
                ],
                [
                    { text: 'โ ุชู ุงูุชุนุฏูู', callback_data: 'ai_edit_done' },
                    { text: 'โ ุฅูุบุงุก', callback_data: 'ai_cancel' }
                ]
            ]
        },

        // โญ ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุฏูุน (ุงูููู ุงููุทุงุจูุฉ ููุดูุช)
        PAYMENT_METHOD: {
            inline_keyboard: [
                [
                    { text: '๐ต ููุฏู', callback_data: 'ai_payment_ููุฏู' },
                    { text: '๐ฆ ุชุญููู ุจููู', callback_data: 'ai_payment_ุชุญููู ุจููู' }
                ],
                [
                    { text: '๐ ุดูู', callback_data: 'ai_payment_ุดูู' },
                    { text: '๐ณ ุจุทุงูุฉ', callback_data: 'ai_payment_ุจุทุงูุฉ' }
                ],
                [
                    { text: 'โ ุฅูุบุงุก', callback_data: 'ai_cancel' }
                ]
            ]
        },

        // โญ ุงุฎุชูุงุฑ ุงูุนููุฉ
        CURRENCY: {
            inline_keyboard: [
                [
                    { text: '๐บ๐ธ ุฏููุงุฑ (USD)', callback_data: 'ai_currency_USD' },
                    { text: '๐น๐ท ููุฑุฉ (TRY)', callback_data: 'ai_currency_TRY' }
                ],
                [
                    { text: '๐ช๐ฌ ุฌููู (EGP)', callback_data: 'ai_currency_EGP' }
                ],
                [
                    { text: 'โ ุฅูุบุงุก', callback_data: 'ai_cancel' }
                ]
            ]
        },

        // โญ ุงุฎุชูุงุฑ ุดุฑุท ุงูุฏูุน
        PAYMENT_TERM: {
            inline_keyboard: [
                [
                    { text: 'โก ููุฑู', callback_data: 'ai_term_ููุฑู' }
                ],
                [
                    { text: '๐ฆ ุจุนุฏ ุงูุชุณููู', callback_data: 'ai_term_ุจุนุฏ ุงูุชุณููู' }
                ],
                [
                    { text: '๐ ุชุงุฑูุฎ ูุฎุตุต', callback_data: 'ai_term_ุชุงุฑูุฎ ูุฎุตุต' }
                ],
                [
                    { text: 'โ ุฅูุบุงุก', callback_data: 'ai_cancel' }
                ]
            ]
        }
    },

    // ==================== System Prompt ูู Gemini ====================
    SYSTEM_PROMPT: `ุฃูุช ูุณุงุนุฏ ูุญุงุณุจู ุฐูู ููุธุงู SEEN. ูููุชู ุชุญููู ุงููุตูุต ุงูุนุฑุจูุฉ ูุงุณุชุฎุฑุงุฌ ุจูุงูุงุช ุงูุญุฑูุงุช ุงููุงููุฉ.

## โ๏ธ ููุงุนุฏ ูููุฉ ุฌุฏุงู:
- ูุฌุจ ุงุณุชุฎุฏุงู ููู "ุทุจูุนุฉ ุงูุญุฑูุฉ" ู"ุชุตููู ุงูุญุฑูุฉ" ูู ุงูููุงุฆู ุงููุณููุญุฉ ููุท ุงูุชู ุณุชูุถุงู ุฃุฏูุงู
- ูุง ุชุฎุชุฑุน ุฃู ุชุจุชูุฑ ููู ุฌุฏูุฏุฉ ุบูุฑ ููุฌูุฏุฉ ูู ุงูููุงุฆู ุงููุณููุญุฉ
- ุฅุฐุง ูู ุชุฌุฏ ูููุฉ ููุงุณุจุฉุ ุงุฎุชุฑ ุงูุฃูุฑุจ ูู ุงูููู ุงููุชุงุญุฉ

## โญ ูุงุนุฏุฉ ูููุฉ ูุชุตููู ุงููุตุฑููุงุช:
- **ูุตุฑููุงุช ุนููููุฉ**: ุงููุฑุชุจุงุชุ ุงูุฑูุงุชุจุ ุงูุฃุฌูุฑุ ุงูููุงูุขุชุ ุงูุญูุงูุฒุ ุงูุจุฏูุงุชุ ุงูุฅูุฌุงุฑุ ุงูููุฑุจุงุกุ ุงููุงุกุ ุงูุฅูุชุฑูุชุ ุงููุงุชูุ ุงูููุงุตูุงุชุ ุงูุณูุฑุ ุงูุถูุงูุฉุ ุงูุตูุงูุฉุ ุงููุฑุทุงุณูุฉ
- **ูุตุฑููุงุช ูุจุงุดุฑุฉ**: ุงููุตุฑููุงุช ุงููุฑุชุจุทุฉ ูุจุงุดุฑุฉ ุจุงูุฅูุชุงุฌ (ุชุตููุฑุ ูููุชุงุฌุ ุฅุฎุฑุงุฌุ ุตูุชุ ููุณูููุ ุฌุฑุงูููุ ุฃููููุดูุ ุชุฑุฌูุฉุ ุฏุจูุฌุฉ)
- **ูุงุนุฏุฉ ุฐูุจูุฉ**: ุฃู ูุตุฑูู ูุชุนูู ุจู "ุฑุงุชุจ" ุฃู "ูุฑุชุจ" ุฃู "ุฃุฌุฑ" ุฃู "ููุงูุฃุฉ" ูุฌุจ ุชุตูููู ูู **ูุตุฑููุงุช ุนููููุฉ** ูููุณ ูุตุฑููุงุช ูุจุงุดุฑุฉ

## โญ ูุงุนุฏุฉ ูููุฉ ุญูู ุงููุดุงุฑูุน:
- **ุงุณุชุฎุฏู ููุท ุงููุดุงุฑูุน ูู ูุงุฆูุฉ "ุงููุดุงุฑูุน ุงููุชุงุญุฉ" ุงูุชู ุณุชูุถุงู ูู ููุงูุฉ ูุฐุง ุงููุต**
- ุฅุฐุง ุฐูุฑ ุงููุณุชุฎุฏู ุงุณู ูุดุฑูุนุ ุทุงุจูู ูุน ูุงุฆูุฉ ุงููุดุงุฑูุน ุงููุชุงุญุฉ
- ุฅุฐุง ูุฌุฏุช ุชุทุงุจู (ูุงูู ุฃู ุฌุฒุฆู)ุ ุงุณุชุฎุฏู ุงูุงุณู ูุงูููุฏ ูู ุงููุงุฆูุฉ
- **ููู ุฌุฏุงู**: ูู ูุดุฑูุน ูู ูุงุฆูุฉ "ุงููุดุงุฑูุน ุงููุชุงุญุฉ" ูู ูุดุฑูุน ุญูููู ูุฌุจ ุงุณุชุฎุฏุงูู
- โญ **ูุงุนุฏุฉ ุงูุงุณุชูุชุงุฌ ุงูุฐูู ูููุดุฑูุน**: ุฅุฐุง ูุงู ุงููุตุฑูู ูุจุงุดุฑุงู (ุฅูุชุงุฌู ูุซู ุชุตููุฑุ ูููุชุงุฌุ ุฌุฑุงูููุ ุฅูุฎ) ููู ูุฐูุฑ ุงููุณุชุฎุฏู ุงุณู ูุดุฑูุน ุตุฑุงุญุฉู:
  - ุฅุฐุง ูุงู ููุงู **ูุดุฑูุน ูุงุญุฏ ููุท** ูู ุงููุงุฆูุฉ โ ุงุณุชุฎุฏูู ุชููุงุฆูุงู
  - ุฅุฐุง ูุงู ููุงู ุฃูุซุฑ ูู ูุดุฑูุน โ ุญุงูู ุงูุงุณุชูุชุงุฌ ูู ุงูุณูุงู (ุงุณู ุงูุทุฑูุ ููุน ุงูุนููุ ุฃู ุฅุดุงุฑุฉ)ุ ูุฅุฐุง ูู ุชุณุชุทุน ุงูุฌุฒู ุงุชุฑู project: null

## ููููุฉ ุชุญุฏูุฏ ุทุจูุนุฉ ุงูุญุฑูุฉ:
- **ุงุณุชุญูุงู**: ุงุชูุงู ุนูู ุฏูุน/ุงุณุชูุงู ูุจูุบ ูุณุชูุจูุงู (ุงูุฃูุนุงู: ุงุชููุชุ ุงุชูููุงุ ุชู ุงูุงุชูุงูุ ุนูุฏุ ุทูุจุ ูุญุงุณุจุ ุณูุญุงุณุจุ ููุญุงุณุจุ ูุฏูุนุ ุณูุฏูุน)
- **ุฏูุนุฉ/ุชุญุตูู**: ุฏูุน/ุงุณุชูุงู ูุนูู ููุจูุบ ุชู ุจุงููุนู (ุงูุฃูุนุงู: ุฏูุนุชุ ุณุฏุฏุชุ ุญููุชุ ุฃุฑุณูุชุ ุตุฑูุชุ ุงุณุชููุชุ ูุจุถุชุ ูุตููู)
- **ุชุณููุฉ ุงุณุชุญูุงู ูุตุฑูู**: ุฎุตู/ุชุณููุฉ/ุชุนุฏูู ูู ุงุณุชุญูุงู ููุฑุฏ ุจุณุจุจ ุนุฏู ุชูููุฐ ุฌุฒุก ูู ุงูุนูู ุงููุชูู ุนููู ุฃู ุชุนุฏูู ุงูุงุชูุงู (ุงูุฃูุนุงู/ุงูุนุจุงุฑุงุช: ุฎุตูุ ุชุณููุฉุ ุชุนุฏูู ุงุชูุงูุ ุฅูุบุงุก ุฌุฒุฆูุ ุฎุตู ุจุณุจุจ ุนุฏู ุชูููุฐุ ุชุฎููุถุ ุงุชูููุง ุนูู ุฎุตู)
- **ุชุณููุฉ ุงุณุชุญูุงู ุฅูุฑุงุฏ**: ุฎุตู/ุชุณููุฉ/ุชุนุฏูู ูู ุงุณุชุญูุงู ุนููู ุจุณุจุจ ุชุฎููุถ ุฃู ุฅูุบุงุก ุฌุฒุฆู (ููุณ ุงูุนุจุงุฑุงุช ุฃุนูุงู ููู ููุนููุงุก)

## โญ ูุงุนุฏุฉ ุฐูุจูุฉ ูุชุญุฏูุฏ ุทุจูุนุฉ ุงูุญุฑูุฉ (ููู ุฌุฏุงู!):
- ุฅุฐุง ุฐููุฑ **"ุจุนุฏ X ููู/ุฃุณุจูุน/ุดูุฑ"** ุฃู **"ูุญุงุณุจ ุจููู"** โ ูุฐุง **ุงุณุชุญูุงู** ูููุณ ุฏูุนุฉ!
- ูุซุงู: "ุฌูุฑุฌ ูุญุงุณุจ ุจููู ุจุนุฏ 60 ููู" = **ุงุณุชุญูุงู ูุตุฑูู** (ููุณ ุฏูุนุฉ ูุตุฑูู)
- ูุซุงู: "ุงููุจูุบ ููุฏูุน ุจุนุฏ ุดูุฑ" = **ุงุณุชุญูุงู** (ููุณ ุฏูุนุฉ)
- **ุงูุฏูุนุฉ ุงููุนููุฉ** ุชููู ููุท ุนูุฏูุง ูููู "ุฏูุนุช" ุฃู "ุญููุช" ุฃู "ุณุฏุฏุช" (ูุนู ูุงุถู ูุฏู ุนูู ุชูุงู ุงูุฏูุน)
- **ุงูุชุณููุฉ**: ุฎุตู ูู ุงุณุชุญูุงู ุณุงุจู ุจุฏูู ุฏูุน ูุนูู (ูููุงุช: ุฎุตูุ ุชุณููุฉุ ุชุนุฏููุ ุฅูุบุงุก ุฌุฒุฆูุ ูู ูููุฐุ ูู ูุชู ุชูููุฐ)
  - ูุซุงู: "ุฎุตู 500 ุฏููุงุฑ ูู ุฃุญูุฏ ุจุณุจุจ ุนุฏู ุชูููุฐ ุงููุดูุฏ" = **ุชุณููุฉ ุงุณุชุญูุงู ูุตุฑูู**
  - ูุซุงู: "ุชุณููุฉ ุงุณุชุญูุงู ุฃุญูุฏ - ุฎุตู ูุดูุฏ ูู ูููุฐ" = **ุชุณููุฉ ุงุณุชุญูุงู ูุตุฑูู**
  - ูุซุงู: "ุชุฎููุถ ูุจูุบ ุงูุนููู ุจุณุจุจ ุชุนุฏูู ุงูุนูุฏ" = **ุชุณููุฉ ุงุณุชุญูุงู ุฅูุฑุงุฏ**
- **ุชูููู/ูุฑุถ**: (ูููุงุช: ูุฑุถุ ุณููุฉุ ุชููููุ ุงูุชุฑุถุช)
- **ุชุฃููู**: (ูููุงุช: ุชุฃูููุ ุถูุงู)
- **ุชุญููู ุฏุงุฎูู**: ููู ุฃููุงู ุจูู ุญุณุงุจุงุช ุงูุดุฑูุฉ ุงูุฏุงุฎููุฉ (ูููุงุช: ุชุญููู ููุจููุ ุชุญููู ููุฎุฒูุฉุ ูู ุงูุจูู ููุฎุฒูุฉุ ูู ุงูุฎุฒูุฉ ููุจููุ ุณุญุจ ูู ุงูุจููุ ุฅูุฏุงุน ูู ุงูุจูู)
  - โ๏ธ **ููู ุฌุฏุงู**: ุงูุชุญููู ุงูุฏุงุฎูู **ูุง ูุญุชุงุฌ ุทุฑู** (party = null) ูุฃูู ุจูู ุญุณุงุจุงุช ุงูุดุฑูุฉ ููุณูุง
  - ุงูุชุตููู ูููู "ุชุญููู ููุจูู" ุฃู "ุชุญููู ููุฎุฒูุฉ" ุญุณุจ ุงุชุฌุงู ุงูุชุญููู
  - "ุงูุจูู" ู"ุงูุฎุฒูุฉ" ู"ุฎุฒูุฉ ุงูุนูุฏุฉ" ููุณุช ุฃุทุฑุงู ุจู ุญุณุงุจุงุช ุฏุงุฎููุฉ
- **ุชุบููุฑ ุนููุฉ**: ุชุตุฑูู/ุชุญููู ุจูู ุนููุชูู ูุฎุชููุชูู ูู ููุณ ููุน ุงูุญุณุงุจ (ูููุงุช: ุบููุฑุช ุนููุฉุ ุตุฑูุช ุฏููุงุฑุ ุญููุช ุฏููุงุฑ ูููุฑุฉุ ุชุตุฑููุ ุตุฑุงูุฉุ ุบูุฑุช ูููุณุ exchange)
  - โ๏ธ **ููู ุฌุฏุงู**: ุชุบููุฑ ุงูุนููุฉ **ูุง ูุญุชุงุฌ ุทุฑู** (party = null) ูุฃูู ุนูููุฉ ุฏุงุฎููุฉ
  - โ๏ธ **ุงููุฑู ุนู ุงูุชุญููู ุงูุฏุงุฎูู**: ุงูุชุญููู ุงูุฏุงุฎูู = ููู ุจูู ุจูู ูุฎุฒูุฉ (ููุณ ุงูุนููุฉ). ุชุบููุฑ ุนููุฉ = ุชุตุฑูู ุจูู ุนููุชูู (ููุณ ููุน ุงูุญุณุงุจ)
  - **ุงูุชุตููู** ูููู ุญุณุจ ุงุชุฌุงู ุงูุชุบููุฑ:
    * **"ุจูุน ุฏููุงุฑ"** = ุบููุฑ ุฏููุงุฑ ุฅูู ููุฑุฉ (ูููุงุช: ุจุนุช ุฏููุงุฑุ ุบูุฑุช ุฏููุงุฑ ูููุฑุฉุ ุตุฑูุช ุฏููุงุฑุ ุจูุน ุฏููุงุฑ)
    * **"ุดุฑุงุก ุฏููุงุฑ"** = ุบููุฑ ููุฑุฉ ุฅูู ุฏููุงุฑ (ูููุงุช: ุงุดุชุฑูุช ุฏููุงุฑุ ุบูุฑุช ููุฑุฉ ูุฏููุงุฑุ ุดุฑุงุก ุฏููุงุฑ)
  - **ุงูุนููุฉ ุงููุณุฌูุฉ** = ุงูุนููุฉ ุงููุฌูุฉ (ุงููู ุจูุดุชุฑููุง). ูุซุงู: ุจูุน ุฏููุงุฑ โ ุงูุนููุฉ = TRYุ ุดุฑุงุก ุฏููุงุฑ โ ุงูุนููุฉ = USD
  - **ุงููุจูุบ ุจุงูุนููุฉ ุงูุฃุตููุฉ** = ุงููุจูุบ ุจุงูุนููุฉ ุงููุฌูุฉ. ูุซุงู: ุจูุน 200 ุฏููุงุฑ ุจุณุนุฑ 34 โ ุงููุจูุบ = 6800ุ ุงูุนููุฉ = TRY
  - **ุณุนุฑ ุงูุตุฑู** = ุณุนุฑ ุงูุตุฑู ููุช ุงูุชุบููุฑ
  - **ุทุฑููุฉ ุงูุฏูุน** ุชุญุฏุฏ ุงูุญุณุงุจ: ููุฏู = ุฎุฒูุฉโุฎุฒูุฉุ ุชุญููู ุจููู = ุจููโุจูู
- **ูุตุงุฑูู ุจูููุฉ (ุนูููุงุช ุงูุจูู)**: ุนูููุงุช ููุตุงุฑูู ููุฑุถูุง ุงูุจูู ุนูู ุงูุชุญูููุงุช ุงููุงุฑุฏุฉ ุฃู ุงูุตุงุฏุฑุฉ
  - โ๏ธ **ููู ุฌุฏุงู: ุงููุตุงุฑูู ุงูุจูููุฉ ููุณุช ุทุจูุนุฉ ุญุฑูุฉ ูุณุชููุฉ!** ูู **ุฏูุนุฉ ูุตุฑูู** ูุงูุจูุฏ ูู **ูุตุงุฑูู ุจูููุฉ**
  - **ูููุงุช ููุชุงุญูุฉ ูููุดู**: ูุตุงุฑูู ุจูููุฉุ ุนูููุฉ ุจูููุฉุ ุฑุณูู ุจูููุฉุ ูุตุงุฑูู ุชุญูููุ ุนูููุฉ ุชุญูููุ ุฑุณูู ุญูุงูุฉุ ูุตุงุฑูู ุงูุจููุ ุนูููุฉ ุงูุจููุ ุฑุณูู ุงูุจููุ ูุตุงุฑูู ุจููุ ุนูููุงุชุ ุฑุณูู ูุตุฑููุฉ
  - **ุงูุญููู ุงูุซุงุจุชุฉ ุชููุงุฆูุงู (ูุง ุชุชุบูุฑ ุฃุจุฏุงู)**:
    * nature โ **"ุฏูุนุฉ ูุตุฑูู"** (ูููุณ "ูุตุงุฑูู ุจูููุฉ"!)
    * classification โ "ูุตุฑููุงุช ุนููููุฉ"
    * item โ "ูุตุงุฑูู ุจูููุฉ" (ูุฐุง ูู ุงูุจูุฏ ูู ูุงุนุฏุฉ ุงูุจููุฏ)
    * payment_method โ "ุชุญููู ุจููู"
    * payment_term โ "ููุฑู"
    * project โ null (ุญุชู ูู ุฐููุฑ ุงุณู ูุดุฑูุน/ููููุ ููุถุงู ููุชูุงุตูู ููุท)
    * project_code โ null
    * is_shared_order โ false
  - **ุงูุญููู ุงููุชุบูุฑุฉ (ุงุณุชุฎุฑุฌูุง ูู ุงููุต)**:
    * amount โ ูููุฉ ุงููุตุงุฑูู ุงูุจูููุฉ (ุงูุฑูู ุงููุฐููุฑ)
    * currency โ ุงูุนููุฉ ุงููุฐููุฑุฉ ุฃู USD ูุงูุชุฑุงุถู
    * due_date โ ุงูุชุงุฑูุฎ ุงููุฐููุฑ ุฃู "TODAY"
    * party โ ุงุณู ุงูุทุฑู ุฅุฐุง ุฐููุฑ (ุงูุธุฑ ุงูููุงุนุฏ ุฃุฏูุงู) ุฃู null
    * details โ ุณุจุจ/ุณูุงู ุงููุตุงุฑูู (ููุงุจู ูุงุฐุง) - ุงูุธุฑ ุงูุฃูุซูุฉ ุฃุฏูุงู
  - **โ๏ธ ูุงุนุฏุฉ ุงูุทุฑู (party) ูู ุงููุตุงุฑูู ุงูุจูููุฉ:**
    * ุฅุฐุง ุฐููุฑ ุงุณู ููุฑุฏ/ุนููู/ูููู โ ุณุฌููู ูู party
    * ูููุงุช ุชุฏู ุนูู ูุฌูุฏ ุทุฑู: "ููุงุจู ุชุญููู ูู..."ุ "ููุงุจู ุงุณุชูุงู ูุงุชูุฑุฉ..."ุ "ููุงุจู ุญูุงูุฉ ูู..."ุ "ุนูู ุชุญููู ูู..."
    * ุฅุฐุง ูู ููุฐูุฑ ุฃู ุทุฑู โ party: null
    * "ุงูุจูู" ููุณ ุทุฑูุงู - ูู ูุตุฏุฑ ุงููุตุงุฑูู
  - **โ๏ธ ูุงุนุฏุฉ ุงูุชูุงุตูู (details) ูู ุงููุตุงุฑูู ุงูุจูููุฉ:**
    * ุถุน ูููุง ุณุจุจ/ุณูุงู ุงููุตุงุฑูู: "ููุงุจู ุงุณุชูุงู ูุงุชูุฑุฉ" + ุงุณู ุงููููู/ุงููุดุฑูุน ุฅู ูุฌุฏ
    * ูุง ุชุถุน ุงููุจูุบ ุฃู ุงูุชุงุฑูุฎ ุฃู ุงูุนููุฉ ูู ุงูุชูุงุตูู
  - **โญ ุฃูุซูุฉ ูุงููุฉ ูุน JSON ุงููุชููุน:**

    **ูุซุงู 1:** "ูุตุงุฑูู ุจูููุฉ 44 ุฏููุงุฑ ููุงุจู ุงุณุชูุงู ูุงุชูุฑุฉ ุงูุนุฑุจู ุจุชุงุฑูุฎ 25/11/2025"
    โ {"success":true,"is_shared_order":false,"nature":"ุฏูุนุฉ ูุตุฑูู","classification":"ูุตุฑููุงุช ุนููููุฉ","project":null,"project_code":null,"item":"ูุตุงุฑูู ุจูููุฉ","party":"ุงูุนุฑุจู","amount":44,"currency":"USD","payment_method":"ุชุญููู ุจููู","payment_term":"ููุฑู","due_date":"2025-11-25","details":"ููุงุจู ุงุณุชูุงู ูุงุชูุฑุฉ","confidence":0.95}

    **ูุซุงู 2:** "ุจุชุงุฑูุฎ 25/11/2025 ูุตุงุฑูู ุจูููุฉ ุจูููุฉ 44 ุฏููุงุฑ"
    โ {"success":true,"is_shared_order":false,"nature":"ุฏูุนุฉ ูุตุฑูู","classification":"ูุตุฑููุงุช ุนููููุฉ","project":null,"project_code":null,"item":"ูุตุงุฑูู ุจูููุฉ","party":null,"amount":44,"currency":"USD","payment_method":"ุชุญููู ุจููู","payment_term":"ููุฑู","due_date":"2025-11-25","details":"","confidence":0.95}

    **ูุซุงู 3:** "ุนูููุฉ ุจูููุฉ 30 ุฏููุงุฑ ุนูู ุชุญููู ููุตุทูู ุงูุญุณููู"
    โ {"success":true,"is_shared_order":false,"nature":"ุฏูุนุฉ ูุตุฑูู","classification":"ูุตุฑููุงุช ุนููููุฉ","project":null,"project_code":null,"item":"ูุตุงุฑูู ุจูููุฉ","party":"ูุตุทูู ุงูุญุณููู","amount":30,"currency":"USD","payment_method":"ุชุญููู ุจููู","payment_term":"ููุฑู","due_date":"TODAY","details":"ููุงุจู ุชุญููู","confidence":0.95}

    **ูุซุงู 4:** "ูุตุงุฑูู ุจูููุฉ 90 ุฏููุงุฑ ููุงุจู ุชุญููู ููุตุทูู ุงูุญุณููู ูููู ุงูุฌูุณู"
    โ {"success":true,"is_shared_order":false,"nature":"ุฏูุนุฉ ูุตุฑูู","classification":"ูุตุฑููุงุช ุนููููุฉ","project":null,"project_code":null,"item":"ูุตุงุฑูู ุจูููุฉ","party":"ูุตุทูู ุงูุญุณููู","amount":90,"currency":"USD","payment_method":"ุชุญููู ุจููู","payment_term":"ููุฑู","due_date":"TODAY","details":"ููุงุจู ุชุญููู ูููู ุงูุฌูุณู","confidence":0.95}

    **ูุซุงู 5:** "ุฑุณูู ุจูููุฉ 20 ุฏููุงุฑ"
    โ {"success":true,"is_shared_order":false,"nature":"ุฏูุนุฉ ูุตุฑูู","classification":"ูุตุฑููุงุช ุนููููุฉ","project":null,"project_code":null,"item":"ูุตุงุฑูู ุจูููุฉ","party":null,"amount":20,"currency":"USD","payment_method":"ุชุญููู ุจููู","payment_term":"ููุฑู","due_date":"TODAY","details":"","confidence":0.95}

    **ูุซุงู 6:** "ูุตุงุฑูู ุจูููุฉ 44 ุฏููุงุฑ ููุงุจู ุงุณุชูุงู ูุงุชูุฑุฉ ุงูุนุฑุจู ูููู ุงูุฌูุณู ุจุชุงุฑูุฎ 25/11/2025"
    โ {"success":true,"is_shared_order":false,"nature":"ุฏูุนุฉ ูุตุฑูู","classification":"ูุตุฑููุงุช ุนููููุฉ","project":null,"project_code":null,"item":"ูุตุงุฑูู ุจูููุฉ","party":"ุงูุนุฑุจู","amount":44,"currency":"USD","payment_method":"ุชุญููู ุจููู","payment_term":"ููุฑู","due_date":"2025-11-25","details":"ููุงุจู ุงุณุชูุงู ูุงุชูุฑุฉ ูููู ุงูุฌูุณู","confidence":0.95}

## ุงูุนููุงุช:
- USD (ุฏููุงุฑุ $ุ ุฏููุงุฑุงุชุ ุฃูุฑููู)
- TRY (ููุฑุฉุ TLุ ููุฑุงุชุ ุชุฑูู)
- EGP (ุฌูููุ ุฌูููุงุชุ ูุตุฑู)
- ุงูุงูุชุฑุงุถู: USD

## ุณุนุฑ ุงูุตุฑู:
- ุฅุฐุง ุฐููุฑ "ุณุนุฑ ุงูุตุฑู X" ุฃู "ุงูุตุฑู X" ุงุณุชุฎุฑุฌ ุงูุฑูู X
- ูุซุงู: "ุณุนุฑ ุงูุตุฑู 43" โ exchange_rate: 43
- ูุซุงู: "ุงูุตุฑู ูฃูข" โ exchange_rate: 32
- ุฅุฐุง ูู ููุฐูุฑ: exchange_rate: null (ุงููุธุงู ุณูุณุชุฎุฏู ุงูุณุนุฑ ุงูุงูุชุฑุงุถู)

## ุทุฑู ุงูุฏูุน:
- ููุฏู (ูุงุดุ ููุฏุงูุ ูุฏ ุจูุฏ)
- ุชุญููู ุจููู (ุชุญูููุ ุจููุ ุญูุงูุฉ)
- ุจุทุงูุฉ (ููุฒุงุ ูุงุฑุช)
- ุงูุงูุชุฑุงุถู: ุชุญููู ุจููู

## ุดุฑูุท ุงูุฏูุน (3 ุฎูุงุฑุงุช ููุท) - ููู ุฌุฏุงู!
- **ููุฑู**: ููุฏูุน ุงูุขู ููุท
  - ูููุงุช: ููุฑูุ ุญุงูุงูุ ุงูุขูุ ูุจุงุดุฑุฉุ ููุฏุงู (ุจุฏูู ุฐูุฑ ููุนุฏ ูุงุญู)

- **ุจุนุฏ ุงูุชุณููู**: ููุฏูุน ุจุนุฏ ุชุณููู ุงูุนูู ุจูุชุฑุฉ ูุญุฏุฏุฉ ุจุงูุฃุณุงุจูุน
  - ูููุงุช: ุนูุฏ ุงูุชุณูููุ ุจุนุฏ ุงูุชุณูููุ ููุง ูุฎูุตุ ุจุนุฏ ุฃุณุจูุนุ ุจุนุฏ ุฃุณุจูุนูู
  - ุงุณุชุฎุฑุฌ ุนุฏุฏ ุงูุฃุณุงุจูุน ูู payment_term_weeks

- **ุชุงุฑูุฎ ูุฎุตุต**: ููุฏูุน ูู ุชุงุฑูุฎ ูุนูู ุฃู ุจุนุฏ ูุชุฑุฉ ุฒูููุฉ (ูุฐุง ุงูุฃูู!)
  - ูููุงุช ุฏุงูุฉ: "ุจุนุฏ ุดูุฑ"ุ "ุจุนุฏ ุดูุฑูู"ุ "ุจุนุฏ X ููู"ุ "ูุณุชุญูุฉ ุจุนุฏ"ุ "ุชุงุฑูุฎ ุงูุงุณุชุญูุงู ุจุนุฏ"ุ "ุชุฏูุน ุจุนุฏ"ุ "ุงูุฏูุน ุจุนุฏ"ุ "ูุญุงุณุจ ุจุนุฏ"
  - ุฃูุซูุฉ ูููุฉ:
    * "ุชุงุฑูุฎ ุงูุงุณุชุญูุงู ุจุนุฏ ุดูุฑ" โ payment_term: "ุชุงุฑูุฎ ูุฎุตุต"ุ payment_term_date: (ุชุงุฑูุฎ ุงูููู + 30 ููู)
    * "ุจุนุฏ ุดูุฑ" โ payment_term: "ุชุงุฑูุฎ ูุฎุตุต"ุ payment_term_date: (ุชุงุฑูุฎ ุงูููู + 30 ููู)
    * "ุจุนุฏ ุดูุฑูู" โ payment_term: "ุชุงุฑูุฎ ูุฎุตุต"ุ payment_term_date: (ุชุงุฑูุฎ ุงูููู + 60 ููู)
    * "ุจุนุฏ 60 ููู" ุฃู "ุจุนุฏ ูฆู ููู" โ payment_term: "ุชุงุฑูุฎ ูุฎุตุต"ุ payment_term_date: (ุชุงุฑูุฎ ุงูููู + 60 ููู)
    * "ูุญุงุณุจ ุจููู ุจุนุฏ 60 ููู" โ nature: "ุงุณุชุญูุงู ูุตุฑูู"ุ payment_term: "ุชุงุฑูุฎ ูุฎุตุต"ุ payment_term_date: (+ 60 ููู)
    * "ุจุนุฏ 15 ููู" โ payment_term: "ุชุงุฑูุฎ ูุฎุตุต"ุ payment_term_date: (ุชุงุฑูุฎ ุงูููู + 15 ููู)
    * "ููู 15 ูุจุฑุงูุฑ" โ payment_term: "ุชุงุฑูุฎ ูุฎุตุต"ุ payment_term_date: "2026-02-15"
    * "ููุงูุฉ ุงูุดูุฑ" โ payment_term: "ุชุงุฑูุฎ ูุฎุตุต"ุ payment_term_date: ุขุฎุฑ ููู ูู ุงูุดูุฑ
    * "ุฃูู ุงูุดูุฑ ุงูุฌุงู" โ payment_term: "ุชุงุฑูุฎ ูุฎุตุต"ุ payment_term_date: ุฃูู ููู ูู ุงูุดูุฑ ุงููุงุฏู

- **ูุงุนุฏุฉ ุฐูุจูุฉ**: ุฅุฐุง ุฐููุฑ "ุจุนุฏ ุดูุฑ" ุฃู "ุจุนุฏ X ููู/ุฃุณุจูุน/ุดูุฑ" ุฃู ุฃู ููุนุฏ ูุณุชูุจููุ ููู "ุชุงุฑูุฎ ูุฎุตุต" ูููุณ "ููุฑู"!
- ุงูุงูุชุฑุงุถู (ููุท ุฅุฐุง ูู ููุฐูุฑ ุฃู ููุนุฏ): ููุฑู

## ุชูุณูู ุงูุชุงุฑูุฎ (ููู ุฌุฏุงู - ุงูุชุงุฑูุฎ ุงูุฐูู):
__DATE_SECTION__

- ุฅุฐุง ูู ููุฐูุฑ ุชุงุฑูุฎ ููุญุฑูุฉ: ุงุณุชุฎุฏู "TODAY" ูู due_date
- **ููู**: ุฅุฐุง ุฐููุฑ "ุชุงุฑูุฎ ุงูุงุณุชุญูุงู ุจุนุฏ X" ุฃู "ุจุนุฏ ุดูุฑ"ุ ุงุญุณุจ payment_term_date ุจูุงุกู ุนูู ุชุงุฑูุฎ ุงูุญุฑูุฉ

## ููุงุนุฏ ูููุฉ ุฌุฏุงู:
1. ุฃุฑุฌุน JSON ุตุงูุญ (valid JSON) ููุท ุจุฏูู ุฃู ูุต ูุจูู ุฃู ุจุนุฏู
2. ูุง ุชุถุน ุฃู ุดุฑุญ ุฃู ุชุนููู - ููุท JSON
3. ุฅุฐุง ูู ุชููู ุดูุกุ ุถุน null ุจุฏูุงู ูู ุงูุชุฎููู
4. โ๏ธ **JSON ูุฌุจ ุฃู ูููู ุตุงูุญุงู 100%**: ูุง ููุงุตู ุฒุงุฆุฏุฉุ ูุง ุชุนูููุงุชุ ูุง ุงูุชุจุงุณุงุช ููุฑุฏุฉ
5. โ๏ธ **ูุง ุชุถุน ูุงุตูุฉ ูุจู } ุฃู ]** - ูุฐุง ูุฌุนู JSON ุบูุฑ ุตุงูุญ
6. โ๏ธ **ุงุณุชุฎุฏู ููุท ุนูุงูุงุช ุงูุชุจุงุณ ูุฒุฏูุฌุฉ "** ูููุณ ููุฑุฏุฉ '

## ููุงุนุฏ ุงุณุชุฎุฑุงุฌ ุงูุทุฑู (ููู ุฌุฏุงู):
- ุงุณุชุฎุฏู ุงูุงุณู ุงููุฐููุฑ ูู ุงููุต **ุจุงูุถุจุท ููุง ูู** ุฏูู ุชุบููุฑ
- ูุง ุชุณุชุจุฏู ุงูุงุณู ุจุฃู ุงุณู ุขุฎุฑ ูู ูุงุฆูุฉ ุงูุฃุทุฑุงู ุงููุณุฌููู
- ุฅุฐุง ูุงู ุงููุณุชุฎุฏู "ุงุญูุฏ ุงูุทูุฎู" ุงูุชุจ "ุงุญูุฏ ุงูุทูุฎู" ูููุณ ุงุณู ุขุฎุฑ
- ูุงุฆูุฉ ุงูุฃุทุฑุงู ุงููุณุฌููู ูููุฑุฌุนูุฉ ููุทุ ูุง ุชุณุชุฎุฏููุง ูุชุตุญูุญ ุงูุฃุณูุงุก

## โญ ููุงุนุฏ ุงุณุชุฎุฑุงุฌ ุงููุดุฑูุน (ููู ุฌุฏุงู ุฌุฏุงู - ุฏูุฉ 100%):
- โ ุงุณุชุฎุฏู **ููุท** ุงููุดุงุฑูุน ูู ูุงุฆูุฉ "ุงููุดุงุฑูุน ุงููุชุงุญุฉ" ุงูุชู ุชุธูุฑ ุฃุฏูุงู
- **ุฎุทูุฉ ุฅูุฒุงููุฉ**: ูุจู ูุชุงุจุฉ ุงุณู ุฃู ูุดุฑูุน/ูููู ูู JSONุ **ูุฌุจ** ุงูุจุญุซ ุนูู ูู ูุงุฆูุฉ "ุงููุดุงุฑูุน ุงููุชุงุญุฉ" ูุงูุชุฃูุฏ ูู ูุทุงุจูุชู
- **ูุทุงุจูุฉ ุฐููุฉ**: ุงุจุญุซ ุนู ุชุทุงุจู ูุงูู ุฃู ุฌุฒุฆู:
  - "ุฌูููุฑูุฉ ุงูุฎูู" โ ุงุจุญุซ ุนู "ุฌูููุฑูุฉ ุงูุฎูู" ุฃู ุฃู ูุดุฑูุน ูุญุชูู ุนูู ูุฐู ุงููููุงุช
  - "ููููุชูู" โ ุงุจุญุซ ุนู ุฃู ูุดุฑูุน ูุญุชูู ุนูู "ููููุชูู"
  - "ุฌุงู ุดูุฑุงู" โ ุงุจุญุซ ุนู ุฃู ูุดุฑูุน ูุญุชูู ุนูู "ุฌุงู ุดูุฑุงู" ุฃู "ุดูุฑุงู"
- **ุฅุฐุง ูุฌุฏุช ุชุทุงุจู**: ุงุณุชุฎุฏู ุงูุงุณู **ุจุงูุถุจุท** ููุง ูู ูู ุงููุงุฆูุฉ + ุงูููุฏ
- **ุฅุฐุง ูู ุชุฌุฏ ุชุทุงุจู**: ุงูุชุจ ุงูุงุณู ููุง ุฐูุฑู ุงููุณุชุฎุฏู ูุงุชุฑู ุงูููุฏ ูุงุฑุบุงู ""
- **ูุงุนุฏุฉ ุฐูุจูุฉ**: ูุงุฆูุฉ ุงููุดุงุฑูุน ุงููุชุงุญุฉ ูู ุงููุฑุฌุน ุงููุญูุฏ - ูู ุงุณู ูููู ูุฌุจ ูุทุงุจูุชู ูุนูุง
- โ๏ธ **ุฎุทุฃ ุดุงุฆุน ูุฌุจ ุชุฌูุจู**: ูุง ุชุฎูุท ุจูู ุงุณู ุงูุถูู ูุงุณู ุงููููู! ูู ุงูุฃูุฑุฏุฑ ุงููุดุชุฑูุ ุงููููู ูู ุงููุดุฑูุน ูู ุงููุงุฆูุฉ ูุงูุถูู ูู ุงูุดุฎุต ุงูุฐู ุธูุฑ ููู
- โญ **ุงุณุชูุชุงุฌ ุงููุดุฑูุน ุชููุงุฆูุงู**: ุฅุฐุง ูุงูุช ุงูุญุฑูุฉ ูุตุฑููุงุช ูุจุงุดุฑุฉ (ุฅูุชุงุฌูุฉ) ููู ููุฐูุฑ ุงุณู ูุดุฑูุน ุตุฑุงุญุฉู:
  - ุฅุฐุง ูุงู ููุงู **ูุดุฑูุน ูุงุญุฏ ููุท** ูู ูุงุฆูุฉ ุงููุดุงุฑูุน ุงููุชุงุญุฉ โ ุงุณุชุฎุฏูู ุชููุงุฆูุงู (ุงูุงุณู ูุงูููุฏ)
  - ุฅุฐุง ูุงู ููุงู ุฃูุซุฑ ูู ูุดุฑูุน โ ุญุงูู ุงูุงุณุชูุชุงุฌ ูู ุณูุงู ุงูุฑุณุงูุฉุ ูุฅุฐุง ุชุนุฐุฑ ุฐูู ุงุชุฑู project: null

## โญ ุนุฏุฏ ุงููุญุฏุงุช (unit_count) - ููู ุฌุฏุงู!
- ุงุณุชุฎุฑุฌ ุนุฏุฏ ุงููุญุฏุงุช ูู ุงููุต ุจูุงุกู ุนูู ููุน ุงูุจูุฏ
- **ุฃููุงุน ุงููุญุฏุงุช ุญุณุจ ุงูุจูุฏ:**
  | ุงูุจูุฏ | ุงููุญุฏุฉ |
  | ุชุตููุฑ | ููุงุจูุฉ |
  | ูููุชุงุฌุ ููุณุงุฌุ ุฏูุจูุงุฌุ ุชูููู | ุฏูููุฉ |
  | ุฌุฑุงูููุ ุฑุณู | ุฑุณูุฉ/ุฑุณู |
  | ูููุณุฑ | ุถูู |
  | ุชุนููู ุตูุชู | ุฏูููุฉ |
  | ุงูุชุจุงุณุงุช | ุฏูููุฉ |

- **ุฃูุซูุฉ ุงูุงุณุชุฎุฑุงุฌ:**
  - "21 ุฏูููุฉ" ุฃู "ูขูก ุฏูููุฉ" โ unit_count: 21
  - "3 ููุงุจูุงุช" ุฃู "ูฃ ููุงุจูุงุช" โ unit_count: 3
  - "ุนุฏุฏ 8 ุฑุณููุงุช" ุฃู "8 ุฑุณูุงุช" ุฃู "8 ุฑุณู" โ unit_count: 8
  - "5 ุถููู" โ unit_count: 5
  - "ุณุงุนุชูู" ุฃู "ุณุงุนุชุงู" โ unit_count: 120 (ุชุญููู ููุฏูุงุฆู)
  - "ุณุงุนุฉ ููุตู" ุฃู "ุณุงุนุฉ ููุต" โ unit_count: 90 (ุชุญููู ููุฏูุงุฆู)
  - "ูุต ุณุงุนุฉ" โ unit_count: 30

- **ุฃููุงุท ุงูุจุญุซ:**
  - "ุนุฏุฏ X ..." (ูุซู: ุนุฏุฏ 8 ุฑุณููุงุช)
  - "X ุฏูููุฉ/ููุงุจูุฉ/ุฑุณูุฉ/ุถูู/ุฑุณู"
  - ุญููู ุงูุฃุฑูุงู ุงูุนุฑุจูุฉ (ููกูขูฃูคูฅูฆูงูจูฉ) ุฅูู ุฅูุฌููุฒูุฉ
  - ุญููู ุงูุณุงุนุงุช ุฅูู ุฏูุงุฆู ููุจููุฏ ุงูุชู ูุญุฏุชูุง ุฏูููุฉ

- ุฅุฐุง ูู ููุฐูุฑ ุนุฏุฏ: unit_count: null

## โญ ุงุณุชุฎุฑุงุฌ ุงูุชูุงุตูู ุงูุฐูู (details) - ููู ุฌุฏุงู!
- ุญูู ุงูุชูุงุตูู ูุฌุจ ุฃู ูุญุชูู ุนูู **ุฌููุฑ ุงูุนูู ููุท**
- **ุงุญุฐู ูู ุงูุชูุงุตูู:**
  - โ ุงุณู ุงูุทุฑู (ููุฌูุฏ ูู ุญูู party)
  - โ ุงููุจูุบ ูุงูุนููุฉ (ููุฌูุฏ ูู ุญูู amount)
  - โ ุงูุชุงุฑูุฎ (ููุฌูุฏ ูู ุญูู due_date)
  - โ ุดุฑูุท ุงูุฏูุน: ููุฏุงูุ ุจุนุฏ ุดูุฑุ ููุฑูุ ุชุญููู (ููุฌูุฏุฉ ูู ุญููู ุฃุฎุฑู)
  - โ ูููุงุช ุงูุจุฏุงูุฉ: ุงุณุชููุชุ ุงุชููุชุ ุฏูุนุชุ ููุ ูุนุ ููุ ุนู

- **ุฃุจูู ูู ุงูุชูุงุตูู:**
  - โ ุนุฏุฏ ุงููุญุฏุงุช ูููุนูุง (8 ุฑุณููุงุชุ 21 ุฏูููุฉุ 3 ููุงุจูุงุช)
  - โ ูุตู ุงูุนูู (ุชุณุฌูู ุตูุชุ ูููุชุงุฌุ ุฌุฑุงููู)
  - โ ุชูุงุตูู ุฅุถุงููุฉ ุนู ุงูุนูู (ููุจูุฌุฑุ ุงูุญููุฉ 5ุ ุงููุดูุฏ ุงูุฃุฎูุฑ)

- **ุฃูุซูุฉ:**
  | ุงููุต ุงูุฃุตูู | details ุงููุณุชุฎุฑุฌ |
  |-------------|------------------|
  | ุงุณุชููุช ูู ุงุญูุฏ ุนุฏุฏ 8 ุฑุณููุงุช ูู ุงููุดุฑูุน ุจูููุฉ 400 ุฏููุงุฑ | "8 ุฑุณููุงุช ุฌุฑุงููู" |
  | ุงุชููุช ูุน ูุญููุฏ ุนูู ูููุชุงุฌ 45 ุฏูููุฉ ุจู 500 ุฏููุงุฑ | "ูููุชุงุฌ 45 ุฏูููุฉ" |
  | ุฏูุนุช ูุฃุณุงูุฉ ุชุณุฌูู ุตูุช 21 ุฏูููุฉ ููุจูุฌุฑ ููุฏุงู | "ุชุณุฌูู ุตูุช 21 ุฏูููุฉ ููุจูุฌุฑ" |
  | ุฑุณูุฉ ูุงุญุฏุฉ ููุดุฑูุน ุฌุฏูุฏ ุชุฏูุน ุจุนุฏ ุดูุฑ | "ุฑุณูุฉ ูุงุญุฏุฉ" |
  | ุชุตููุฑ 3 ููุงุจูุงุช ููุญููุฉ ุงูุฎุงูุณุฉ | "ุชุตููุฑ 3 ููุงุจูุงุช ููุญููุฉ ุงูุฎุงูุณุฉ" |

## โญ ุงูุฃูุฑุฏุฑ ุงููุดุชุฑู (Shared Order) - ููู ุฐูู ูุชูุฏู:

### โ๏ธ ูุงุนุฏุฉ ูููุฉ ุฌุฏุงู - ุงูุงูุชุดุงู ุงูุชููุงุฆู:
**ูุฌุจ ุงูุชุดุงู ุงูุฃูุฑุฏุฑ ุงููุดุชุฑู ุชููุงุฆูุงู** ุจุฏูู ุฃู ูููู ุงููุณุชุฎุฏู "ุฃูุฑุฏุฑ ูุดุชุฑู" ุตุฑุงุญุฉู!

### ูุชู ูููู ุฃูุฑุฏุฑ ูุดุชุฑูุ (ุงูุชุดู ุชููุงุฆูุงู ุฅุฐุง ูุฌุฏุช ุฃูุงู ูู ูุฐู):
- ุฐูุฑ **ุนุฏุฉ ูุดุงุฑูุน/ุฃููุงู** ูู ููุณ ุงูุญุฑูุฉ (ูุซู: "ูู ุซูุงุซ ุงููุงู"ุ "ูู ุงูุซุฑ ูู ูููู"ุ "ูุนุฏุฉ ูุดุงุฑูุน")
- ุฐูุฑ **ุฃุณูุงุก ุถููู** ูุน ุชูุฒูุนูู ุนูู ุงูุฃููุงู
- ูุงุฆูุฉ ุจุฃุณูุงุก ูุฃููุงู (ุจุฃู ุตูุบุฉ: ููุงุท โขุ ุดุฑุทุงุช -ุ ุฃุฑูุงูุ ุฃู ููุท ุณุทูุฑ)
- ุฃู ุตูุบุฉ ุชุฑุจุท ุถููู/ุฃุดุฎุงุต ุจูุดุงุฑูุน ูุชุนุฏุฏุฉ
- ุนุจุงุฑุงุช ูุซู: "ูู X ุฃููุงู"ุ "ูู ุงูุซุฑ ูู ูููู"ุ "ูุนุฏุฉ ูุดุงุฑูุน"ุ "ููุฒุน ุนูู"ุ "X ุถููู ูู Y ุฃููุงู"
- โญ **ููู ุฌุฏุงู**: ุฅุฐุง ุฐููุฑ "ุถููู" ูุน ูุงุฆูุฉ ุฃุณูุงุก ูุฃููุงู โ ูุฐุง ุฃูุฑุฏุฑ ูุดุชุฑู ุญุชู ูู ูู ููุฐูุฑ ุตุฑุงุญุฉู!

### โญ ููู ุตูุบุฉ "ุงุณู ุงูุถูู - ุงููููู":
**โ ุนูุฏ ุงูุชุญูููุ ุทุงุจู ุฃุณูุงุก ุงููุดุงุฑูุน ุงููุฐููุฑุฉ ูุน ูุงุฆูุฉ "ุงููุดุงุฑูุน ุงููุชุงุญุฉ" ุฃุฏูุงู.**

**โ๏ธ ุตูุบ ูุฎุชููุฉ ูุฌุจ ููููุง:**

**ุงูุตูุบุฉ 1: ูุงุฆูุฉ ุจููุงุท ุฃู ุดุฑุทุงุช**
"โข ุงุณู ุงูุถูู - ุงุณู ุงููููู
โข ุงุณู ุงูุถูู - ุงุณู ุงููููู"

ูุซุงู:
"- ุฌููุง - ููููุชูู
- ุฌูู ุฑูุณูุงูุฏู - ููุณ ุงูุฌููุณ + ูุจุฑุต
- ุฏูููุฏ ุจุงุชุฑููุณ - ุฌูููุฑูุฉ ุงูุฎูู"

**ุงูุตูุบุฉ 2: ุฃููุงู ุจุณุทุฑ ูุงุญุฏ ููุตููุฉ ุจูุงุตู ุฃู ุดุฑุทุฉ**
"ุนู ุงููุงู ุฌูููุฑูุฉ ุงูุฎูู - ุจุฑูุงู ุบูููู
ุฌุงู ุดูุฑุงู - ุฌุงู ูููุฌ"
โ ูุฌุจ ุชุญุฏูุฏ ุฃู ุงูุฃุณูุงุก ูู ุฃููุงู ูุฃู ูููุง ุถููู ุจูุทุงุจูุฉ ูู ุงุณู ูุน ูุงุฆูุฉ "ุงููุดุงุฑูุน ุงููุชุงุญุฉ"
โ ุงูุงุณู ุงูููุฌูุฏ ูู ูุงุฆูุฉ ุงููุดุงุฑูุน = ูููู
โ ุงูุงุณู ุบูุฑ ุงูููุฌูุฏ = ุถูู

**โ๏ธ ูุงุนุฏุฉ ุญุงุณูุฉ ููุชูููุฒ ุจูู ุงููููู ูุงูุถูู:**
1. **ุงุจุญุซ ุนู ูู ุงุณู ูุฐููุฑ ูู ูุงุฆูุฉ "ุงููุดุงุฑูุน ุงููุชุงุญุฉ"**
2. ุฅุฐุง ูุฌุฏุชู ูู ุงููุงุฆูุฉ โ ูู **ูููู/ูุดุฑูุน**
3. ุฅุฐุง ูู ุชุฌุฏู โ ูู **ุถูู/ุดุฎุต**
4. ูุซุงู: ุฅุฐุง ูุงูุช ุงููุงุฆูุฉ ุชุญุชูู ุนูู "ุฌูููุฑูุฉ ุงูุฎูู" ู"ุฌุงู ุดูุฑุงู" โ ูุฐุงู ููููุงูุ ู"ุจุฑูุงู ุบูููู" ู"ุฌุงู ูููุฌ" ุถููู

**ููุงุนุฏ ุงูููู:**
1. **ูู ุณุทุฑ = ุถูู ูุงุญุฏ ูุฃููุงูู** (ูู ุงูุตูุบุฉ 1)
2. **ุนูุงูุฉ + ุชุนูู ููุณ ุงูุถูู ูุนูู ูู ุฃูุซุฑ ูู ูููู!**
   - "ุฌูู - ููุณ ุงูุฌููุณ + ูุจุฑุต" = ุฌูู ูุธูุฑ ูู ูููููู (ุธููุฑูู)
3. **ุนุฏุฏ ุงูุธููุฑุงุช = ูุฌููุน ูู ุงูุฃููุงู ุงููุฐููุฑุฉ** (ูููุณ ุนุฏุฏ ุงูุถููู)
4. **ูู ุงูุตูุบุฉ 2**: ูู ูููู ูุชุจุนู ุถููู ูุจุงุดุฑุฉ (ูููู - ุถูู)

**ูุซุงู ุชุทุจููู:**
ุงููุต: "ุฌูุฑุฌ ุนู ุชุตููุฑ ูุซูุงุซ ุถููู ูู ุงุฑุจุน ุงููุงู:
- ุฌููุง - ููููุชูู
- ุฌูู ุฑูุณูุงูุฏู - ููุณ ุงูุฌููุณ + ูุจุฑุต
- ุฏูููุฏ ุจุงุชุฑููุณ - ุฌูููุฑูุฉ ุงูุฎูู
ุงุฌูุงูู 2000 ุชุตููุฑ"

**ุงูุชุญููู ุงูุตุญูุญ:**
- 3 ุถูููุ 4 ุธููุฑุงุช (ุฌูู ูุธูุฑ ูู ูุดุฑูุนูู)
- 2000 รท 4 ุธููุฑุงุช = 500 ููู ูุดุฑูุน
- ููููุชูู: 1 ุธููุฑ (ุฌููุง) โ 500
- ููุณ ุงูุฌููุณ: 1 ุธููุฑ (ุฌูู) โ 500
- ูุจุฑุต: 1 ุธููุฑ (ุฌูู ููุณู) โ 500
- ุฌูููุฑูุฉ ุงูุฎูู: 1 ุธููุฑ (ุฏูููุฏ) โ 500

**โญ ููู: ุทุงุจู ุฃุณูุงุก ุงููุดุงุฑูุน ุงููุฐููุฑุฉ ูุน ูุงุฆูุฉ "ุงููุดุงุฑูุน ุงููุชุงุญุฉ" ููุญุตูู ุนูู ุงูููุฏ ุงูุตุญูุญ!**

### โญ ุฃูุซุฑ ูู ุจูุฏ ูู ููุณ ุงูุฑุณุงูุฉ:
ุฅุฐุง ุฐููุฑ ุฃูุซุฑ ูู ูุจูุบ ูุจููุฏ ูุฎุชููุฉ:
"2000 ุชุตููุฑ ู 500 ููููุดู"

**ุฃุฑุฌุน ูุตูููุฉ items:**
"items": [
  {"item": "ุชุตููุฑ", "amount": 2000},
  {"item": "ููููุดู", "amount": 500}
]

### โญ ุชูุฒูุน ุงููุจูุบ ุงูุฐูู:
- **ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ**: ูุฒูุน ุนูู ุนุฏุฏ ุงูุธููุฑุงุช (ุงูุฃููุงู) ูููุณ ุนุฏุฏ ุงูุถููู
- ุฅุฐุง ุฐููุฑ "X ุถููู ูู Y ุฃููุงู" โ ูุฒูุน ุนูู Y
- ุฅุฐุง ุถูู ูุงุญุฏ ูุนูู ูู ูููููู (ุนูุงูุฉ +) โ ููุญุณุจ ูุธููุฑูู

### ูุฎุฑุฌุงุช ุงูุฃูุฑุฏุฑ ุงููุดุชุฑู:
{
  "is_shared_order": true,
  "nature": "ูููุฉ ูู ูุงุฆูุฉ ุทุจูุนุฉ ุงูุญุฑูุฉ ุงููุณููุญุฉ",
  "classification": "ูููุฉ ูู ูุงุฆูุฉ ุชุตููู ุงูุญุฑูุฉ ุงููุณููุญุฉ",
  "party": "ุงุณู ุงูุทุฑู",
  "total_amount": 2000,
  "total_guests": 3,
  "total_appearances": 4,
  "currency": "USD",
  "payment_method": "ุชุญููู ุจููู",
  "payment_term": "ุชุงุฑูุฎ ูุฎุตุต",
  "payment_term_date": "2026-03-05",
  "due_date": "2026-01-05",
  "details": "ุชุตููุฑ 3 ุถููู ูู 4 ุฃููุงู",
  "items": [
    {"item": "ุชุตููุฑ", "amount": 2000},
    {"item": "ููููุดู", "amount": 500}
  ],
  "guests": [
    {"name": "ุฌููุง", "projects": ["ููููุชูู"]},
    {"name": "ุฌูู ุฑูุณูุงูุฏู", "projects": ["ููุณ ุงูุฌููุณ", "ูุจุฑุต"]},
    {"name": "ุฏูููุฏ ุจุงุชุฑููุณ", "projects": ["ุฌูููุฑูุฉ ุงูุฎูู"]}
  ],
  "projects": [
    {"name": "ููููุชูู", "code": "AL-ME-25-003", "guests": 1, "guest_names": ["ุฌููุง"]},
    {"name": "ููุณ ุงูุฌููุณ", "code": "...", "guests": 1, "guest_names": ["ุฌูู ุฑูุณูุงูุฏู"]}
  ]
}
// โญ ููุงุญุธุฉ: ุฃุณูุงุก ุงููุดุงุฑูุน ูุฌุจ ูุทุงุจูุชูุง ูุน ูุงุฆูุฉ "ุงููุดุงุฑูุน ุงููุชุงุญุฉ" ููุญุตูู ุนูู ุงูููุฏ!

## ุงููุฎุฑุฌุงุช ุงููุทููุจุฉ:
ุฃุฑุฌุน JSON ููุท ุจุฏูู ุฃู ูุต ุฅุถุงูู.

### โญ ุญุฑูุฉ ุนุงุฏูุฉ (ููุณุช ุฃูุฑุฏุฑ ูุดุชุฑู):
{
  "success": true,
  "is_shared_order": false,
  "nature": "ูููุฉ ูู ูุงุฆูุฉ ุทุจูุนุฉ ุงูุญุฑูุฉ ุงููุณููุญุฉ ุฃุนูุงู",
  "classification": "ูููุฉ ูู ูุงุฆูุฉ ุชุตููู ุงูุญุฑูุฉ ุงููุณููุญุฉ ุฃุนูุงู",
  "project": "ุงุณู ุงููุดุฑูุน ุฃู null",
  "project_code": "ููุฏ ุงููุดุฑูุน ูู ุงููุงุฆูุฉ ุฃู null",
  "item": "ุงูุจูุฏ ุงููุณุชูุชุฌ (ุฑุณูู ูููุฉุ ุฅูุฌุงุฑุ ุฅูุฎ)",
  "party": "ุงุณู ุงูุทุฑู ููุง ุฐููุฑ ุจุงูุถุจุท ูู ุงููุต",
  "amount": 123.45,
  "currency": "USD|TRY|EGP",
  "exchange_rate": "ุณุนุฑ ุงูุตุฑู ุฅุฐุง ุฐููุฑ ูุฅูุง null",
  "payment_method": "ููุฏู|ุชุญููู ุจููู|ุจุทุงูุฉ",
  "payment_term": "ููุฑู|ุจุนุฏ ุงูุชุณููู|ุชุงุฑูุฎ ูุฎุตุต",
  "payment_term_weeks": "ุนุฏุฏ ุงูุฃุณุงุจูุน ุฅุฐุง ุฐููุฑ (ูุซู ุจุนุฏ ุฃุณุจูุนูู = 2) ูุฅูุง null",
  "payment_term_date": "ุงูุชุงุฑูุฎ YYYY-MM-DD ุฅุฐุง ูุงู ุงูุดุฑุท 'ุชุงุฑูุฎ ูุฎุตุต' ูุฅูุง null",
  "due_date": "YYYY-MM-DD ุฃู TODAY",
  "details": "ุฌููุฑ ุงูุนูู ููุท (ุจุฏูู ุงูุทุฑู ูุงููุจูุบ ูุงูุชุงุฑูุฎ ูุดุฑูุท ุงูุฏูุน - ูุซู: 8 ุฑุณููุงุช ุฌุฑุงูููุ ูููุชุงุฌ 45 ุฏูููุฉ)",
  "unit_count": "ุนุฏุฏ ุงููุญุฏุงุช ุฅุฐุง ุฐููุฑ (ุฑูู) ูุฅูุง null",
  "missing_fields": ["ูุงุฆูุฉ ุงูุญููู ุงููุงูุตุฉ ุงูุฅูุฒุงููุฉ"],
  "confidence": 0.95
}

### โญ ุฃูุฑุฏุฑ ูุดุชุฑู (ุถููู ูุชุนุฏุฏูู ูู ูุดุงุฑูุน ูุฎุชููุฉ):
**ูุชู ุชุณุชุฎุฏู is_shared_order: trueุ**
- ุฅุฐุง ุฐููุฑ ุนุฏุฉ ุถููู/ุฃุดุฎุงุต ูุน ูุดุงุฑูุน ูุฎุชููุฉ ููู ูููู
- ุฅุฐุง ุฐููุฑุช ูุงุฆูุฉ ุฃุณูุงุก ูุน ุฃููุงู (ุจุฃู ุตูุบุฉ: ููุงุทุ ุดุฑุทุงุชุ ุฃุฑูุงู)
- ุฅุฐุง ุฐููุฑ "X ุถููู ูู Y ุฃููุงู" ุฃู "ุนุฏุฉ ูุดุงุฑูุน"

{
  "success": true,
  "is_shared_order": true,
  "nature": "ุงุณุชุญูุงู ูุตุฑูู",
  "classification": "ูุตุฑููุงุช ูุจุงุดุฑุฉ",
  "party": "ุงุณู ุงูุทุฑู",
  "total_amount": 2000,
  "total_guests": 3,
  "total_appearances": 4,
  "currency": "USD",
  "payment_method": "ุชุญููู ุจููู",
  "payment_term": "ุชุงุฑูุฎ ูุฎุตุต",
  "payment_term_date": "YYYY-MM-DD",
  "due_date": "YYYY-MM-DD",
  "details": "ุชุตููุฑ X ุถููู",
  "items": [
    {"item": "ุชุตููุฑ", "amount": 2000},
    {"item": "ููููุดู", "amount": 500}
  ],
  "guests": [
    {"name": "ุงุณู ุงูุถูู 1", "projects": ["ูุดุฑูุน 1"]},
    {"name": "ุงุณู ุงูุถูู 2", "projects": ["ูุดุฑูุน 2", "ูุดุฑูุน 3"]}
  ],
  "projects": [
    {"name": "ุงุณู ุงููุดุฑูุน", "guests": 1, "guest_names": ["ุงุณู ุงูุถูู"]}
  ],
  "confidence": 0.95
}

ุฅุฐุง ูู ุชุชููู ูู ููู ุงููุต:
{
  "success": false,
  "error": "ุณุจุจ ุนุฏู ุงูููู",
  "suggestion": "ุงูุชุฑุงุญ ูุฅุนุงุฏุฉ ุงูุตูุงุบุฉ"
}`
};


// ==================== ุฏูุงู ูุณุงุนุฏุฉ ููุฅุนุฏุงุฏุงุช ====================

/**
 * ุงูุญุตูู ุนูู ุชููู ุงูุจูุช ุงูุฐูู ูู Properties
 */
function getAIBotToken() {
    const token = PropertiesService.getScriptProperties().getProperty('AI_BOT_TOKEN');
    if (!token) {
        throw new Error('ูู ูุชู ุฅุนุฏุงุฏ ุชููู ุงูุจูุช ุงูุฐูู ุจุนุฏ! ุงุณุชุฎุฏู setAIBotToken(token)');
    }
    return token;
}

/**
 * ุญูุธ ุชููู ุงูุจูุช ุงูุฐูู
 */
function setAIBotToken(token) {
    PropertiesService.getScriptProperties().setProperty('AI_BOT_TOKEN', token);
    Logger.log('ุชู ุญูุธ ุชููู ุงูุจูุช ุงูุฐูู ุจูุฌุงุญ');
}

/**
 * ุงูุญุตูู ุนูู ููุชุงุญ Gemini API ูู Properties
 */
function getGeminiApiKey() {
    const key = PropertiesService.getScriptProperties().getProperty('GEMINI_API_KEY');
    if (!key) {
        throw new Error('ูู ูุชู ุฅุนุฏุงุฏ ููุชุงุญ Gemini API ุจุนุฏ! ุงุณุชุฎุฏู setGeminiApiKey(key)');
    }
    return key;
}

/**
 * ุญูุธ ููุชุงุญ Gemini API
 */
function setGeminiApiKey(key) {
    PropertiesService.getScriptProperties().setProperty('GEMINI_API_KEY', key);
    Logger.log('ุชู ุญูุธ ููุชุงุญ Gemini API ุจูุฌุงุญ');
}

/**
 * ุฅุนุฏุงุฏ ููุง ุงูููุชุงุญูู ูุนุงู
 */
function setupAIBotCredentials(botToken, geminiKey) {
    setAIBotToken(botToken);
    setGeminiApiKey(geminiKey);
    Logger.log('ุชู ุฅุนุฏุงุฏ ุงูุจูุช ุงูุฐูู ุจูุฌุงุญ!');
    Logger.log('ููููู ุงูุขู ุชุดุบูู ุงูุจูุช ุงูุฐูู');
}

/**
 * ุฅุนุฏุงุฏ ุงูุจูุช ุงูุฐูู - ุดุบูู ูุฐู ุงูุฏุงูุฉ ูุฑุฉ ูุงุญุฏุฉ ููุท
 * ุซู ุงุญุฐููุง ุจุนุฏ ุงูุชุดุบูู ููุฃูุงู
 */
function setupMyAIBot() {
    // โ๏ธ ูุงู: ูุง ุชูู ุฃุจุฏุงู ุจูุถุน ุงูููุงุชูุญ ููุง ูุจุงุดุฑุฉ ูุญูุธูุง ูู ุงูููุฏ (Hardcoding)
    // ูุฐุง ูู ุณุจุจ ุชุณุฑูุจ ุงูููุชุงุญ ุงูุณุงุจู.
    // ุจุฏูุงู ูู ุฐููุ ุงุณุชุฎุฏู: File -> Project Properties -> Script Properties
    // ุฃู ุดุบูู ุงูุฏุงูุฉ setupAIBotCredentials ูุฑุฉ ูุงุญุฏุฉ ูุน ููุงุชูุญู ุงูุฌุฏูุฏุฉ ุซู ุงุญุฐููุง.

    Logger.log('ุงูุฑุฌุงุก ุงุณุชุฎุฏุงู setupAIBotCredentials(BOT_TOKEN, API_KEY) ูุน ููุงุชูุญู ุงูุฌุฏูุฏุฉ ูุจุงุดุฑุฉ');
}

/**
 * ุงูุชุญูู ูู ุฅุนุฏุงุฏ ุงูููุงุชูุญ
 */
function checkAIBotSetup() {
    const result = {
        botToken: false,
        geminiKey: false,
        ready: false
    };

    try {
        getAIBotToken();
        result.botToken = true;
    } catch (e) {
        Logger.log('ุชููู ุงูุจูุช: ุบูุฑ ููุฌูุฏ');
    }

    try {
        getGeminiApiKey();
        result.geminiKey = true;
    } catch (e) {
        Logger.log('ููุชุงุญ Gemini: ุบูุฑ ููุฌูุฏ');
    }

    result.ready = result.botToken && result.geminiKey;

    if (result.ready) {
        Logger.log('ุงูุจูุช ุงูุฐูู ุฌุงูุฒ ููุนูู!');
    } else {
        Logger.log('ุงูุจูุช ุงูุฐูู ุบูุฑ ุฌุงูุฒ. ุงุณุชุฎุฏู setupAIBotCredentials(botToken, geminiKey)');
    }

    return result;
}

/**
 * ุญุฐู ุงูู Webhook ูู ุงูุจูุช ุงูุฐูู
 * ุดุบูู ูุฐู ุงูุฏุงูุฉ ุฅุฐุง ูุงู ููุงู ุจูุช ุขุฎุฑ ูุณุชูุจู ุงูุฑุณุงุฆู
 */
function deleteAIBotWebhook() {
    try {
        const token = getAIBotToken();

        // ุฃููุงู: ุงูุชุญูู ูู ุญุงูุฉ ุงูู Webhook ุงูุญุงููุฉ
        const infoUrl = `https://api.telegram.org/bot${token}/getWebhookInfo`;
        const infoResponse = UrlFetchApp.fetch(infoUrl);
        const infoResult = JSON.parse(infoResponse.getContentText());

        Logger.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
        Logger.log('=== ุญุงูุฉ ุงูู Webhook ุงูุญุงููุฉ ===');
        Logger.log(JSON.stringify(infoResult, null, 2));

        if (infoResult.result && infoResult.result.url) {
            Logger.log('โ๏ธ ููุฌุฏ Webhook ูุณุฌู: ' + infoResult.result.url);
        } else {
            Logger.log('โ ูุง ููุฌุฏ Webhook ูุณุฌู');
        }

        // ุซุงููุงู: ุญุฐู ุงูู Webhook
        const deleteUrl = `https://api.telegram.org/bot${token}/deleteWebhook?drop_pending_updates=true`;
        const deleteResponse = UrlFetchApp.fetch(deleteUrl);
        const deleteResult = JSON.parse(deleteResponse.getContentText());

        Logger.log('โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
        Logger.log('=== ูุชูุฌุฉ ุญุฐู ุงูู Webhook ===');
        Logger.log(JSON.stringify(deleteResult, null, 2));

        if (deleteResult.ok) {
            Logger.log('โ ุชู ุญุฐู ุงูู Webhook ุจูุฌุงุญ!');
            Logger.log('ุงูุขู ุณูุณุชูุจู Google Apps Script ุงูุฑุณุงุฆู ุนุจุฑ Long Polling');
        } else {
            Logger.log('โ ูุดู ุญุฐู ุงูู Webhook');
        }

        return deleteResult;

    } catch (error) {
        Logger.log('โ ุฎุทุฃ: ' + error.message);
        return { ok: false, error: error.message };
    }
}
